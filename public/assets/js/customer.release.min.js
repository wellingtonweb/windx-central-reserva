function releaseCustomer(o) {
    $(".loading").removeClass("d-none"), fetch(release_url, {
        method: "POST",
        body: JSON.stringify({id: o, cpf_cnpj: "{{session('customerActive')->document}}"}),
        mode: "cors",
        headers: {
            "Content-Type": "application/json; charset=UTF-8",
            "x-csrf-token": $("meta[name='csrf-token']").attr("content")
        }
    }).then(o => o.json()).then(o => {
        if("ERRO2" === o){
            $(".loading").addClass("d-none");
            notifyMessage(409, "error", "Este cadastro foi liberado a menos de 30 dias!")
        }else if("NOK" === o){
            $(".loading").addClass("d-none");
            notifyMessage(409, "error", "Este cadastro n\xe3o est\xe1 bloqueado ou n\xe3o possu\xed boletos!")
        }else{
            $(".loading").addClass("d-none");
            $("#btn-release-home").addClass('d-none');
            $("#btn-release-sidebar").addClass('d-none');
            notifyMessage(200, "success", "Regularize seus débitos e evite novos bloqueios.")
        }

        // "ERRO2" === o ? ($(".loading").addClass("d-none"), notifyMessage(409, "error", "Este cadastro foi liberado a menos de 30 dias!")) : "NOK" === o ? ($(".loading").addClass("d-none"), notifyMessage(409, "error", "Este cadastro n\xe3o est\xe1 bloqueado ou n\xe3o possu\xed boletos!")) : ($(".loading").addClass("d-none"), notifyMessage(200, "success", "Regularize seus débitos e evite novos bloqueios."))
    }).catch(o => {
        console.log("Error: ", o.message)
    })
}

function notifyMessage(code, status, message){
    Swal.fire({
        icon: status,
        title: code != 200 ? 'Desculpe!' : 'Cadastro liberado com sucesso!',
        html: message,
        timer: 7000,
        willClose: () => {
            code === 200 ? location.reload() : ''
        },
        allowOutsideClick: () => {
            const popup = Swal.getPopup()
            popup.classList.remove('swal2-show')
            setTimeout(() => {
                popup.classList.add('animate__animated', 'animate__headShake')
            })
            setTimeout(() => {
                popup.classList.remove('animate__animated', 'animate__headShake')
            }, 500)
            return false
        },
    });
}
